swagger: '2.0'
info:
  title: EHRServer
  description: Clinical Information Management and Sharing Platform
  version: 0.9.5
host: ehrserver-cabolabs2.rhcloud.com
schemes:
  - https
basePath: /api/v1
tags:
  - name: administrative
    description: Non-clinical related services
  - name: users
    description: Endpoints related to client or user authorization for the REST API
  - name: ehrs
    description: Enpoint related to health record management
  - name: queries
    description: Endpoints related to data queries
produces:
  - application/json
  - text/xml
paths:
  /login:
    post:
      tags:
        - administrative
      summary: Authorize credentials and get auth token
      parameters:
        - name: username
          in: query
          required: true
          type: string
        - name: password
          in: query
          required: true
          type: string
        - name: organization
          in: query
          description: Organization number of an organization associated with the user.
          required: true
          type: integer
          format: int32
        - name: format
          in: query
          description: desired output format
          type: string
          enum:
            - xml
            - json
          default: json
      produces:
        - application/json
      responses:
        '200':
          description: Token de seguridad
          examples:
            application/json:
              token: >-
                eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im9yZ21hbiIsIm...
        '401':
          description: Authentication failed
          examples:
            applicaton/json:
              result:
                type: AR
                message: Authentication failed
                code: 'EHR_SERVER::API::ERRORS::e01.0001'
  /users:
    post:
      tags:
        - administrative
      summary: Crate a new user and associate it with the current organization.
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: username
          in: query
          required: true
          type: string
        - name: email
          in: query
          required: true
          type: string
          format: email
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: user profile
          examples:
            application/json:
              username: pablo
              email: pablo@gmail.com
              organizations:
                - uid: d8b5bcb6-f26a-4192-a754-b98f62cd1234
                  name: CaboLabs
                  number: '123456'
  '/users/{username}':
    get:
      tags:
        - administrative
      summary: Get user profile.
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: username
          in: path
          required: true
          type: string
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: user profile
          examples:
            application/json:
              username: pablo
              email: pablo@gmail.com
              organizations:
                - uid: d8b5bcb6-f26a-4192-a754-b98f62cd1234
                  name: CaboLabs
                  number: '123456'
  /ehrs:
    get:
      summary: Retrieve health records associated with the current organization.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: max
          in: query
          description: number or EHRs per page
          required: false
          type: integer
          format: int32
          default: 10
        - name: offset
          in: query
          description: pagination offset
          required: false
          type: integer
          format: int32
          default: 0
      responses:
        '200':
          description: EHR list with pagination data.
          examples:
            application/json:
              ehrs:
                - uid: c35dfe02-4ece-465e-9433-0540c6d95f3f
                  dateCreated: '2017-02-11 18:55:18'
                  subjectUid: '11111111'
                  systemId: CABOLABS_EHR_SERVER
                  organizationUid: d8b5bcb6-f26a-4192-a754-b98f62cd1234
              pagination:
                max: 10
                offset: 0
                nextOffset: 10
                prevOffset: 0
              timing: 0 ms
    post:
      summary: Create a new EHR for a subject.
      description: >-
        Store the subjectUid in your system to be able to query the EHRServer by
        the subjectUid.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: subjectUid
          in: query
          type: string
          required: true
      responses:
        '200':
          description: EHR resource.
          examples:
            application/json:
              uid: b11f37ca-2483-47e1-93aa-93681342ddb1
              dateCreated: '2017-06-04 19:16:26'
              subjectUid: 9f7fe6aa-c4f1-4d86-af8a-c1787e599a9b
              systemId: CABOLABS_EHR_SERVER
              organizationUid: d8b5bcb6-f26a-4192-a754-b98f62cdc4a4
  '/ehrs/ehrUid/{uid}':
    get:
      summary: Get an EHR by it's UID.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: uid
          in: path
          required: true
          type: string
      produces:
        - application/json
        - text/text
      responses:
        '200':
          description: EHR resource.
          examples:
            application/json:
              uid: c35dfe02-4ece-465e-9433-0540c6d95f3f
              dateCreated: '2017-02-11 18:55:18'
              subjectUid: '11111111'
              systemId: CABOLABS_EHR_SERVER
              organizationUid: d8b5bcb6-f26a-4192-a754-b98f62cd1234
  '/ehrs/subjectUid/{uid}':
    get:
      summary: Get an EHR by subject UID.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: uid
          in: path
          required: true
          type: string
      produces:
        - application/json
        - text/text
      responses:
        '200':
          description: EHR resource.
          examples:
            application/json:
              uid: c35dfe02-4ece-465e-9433-0540c6d95f3f
              dateCreated: '2017-02-11 18:55:18'
              subjectUid: '11111111'
              systemId: CABOLABS_EHR_SERVER
              organizationUid: d8b5bcb6-f26a-4192-a754-b98f62cd1234
  '/ehrs/{uid}/contributions':
    get:
      summary: Get the EHR contributions.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: uid
          in: path
          description: UID of the EHR
          required: true
          type: string
      produces:
        - application/json
        - text/text
      responses:
        '200':
          description: EHR contributions.
          examples:
            application/json:
              contributions:
                - uid: 42ff9ad9-d7b7-4f92-b69a-03f39b24c4c5
                  organizationUid: 41467ac9-18a0-49d8-bbdd-5954efb13399
                  ehrUid: afd64629-93a9-49ea-b7f8-540106bba979
                  versions:
                    - '9345f598-65b1-4738-9054-73a40e2d5774::EMR::1'
                  audit:
                    timeCommitted: '2017-06-05 19:52:30'
                    committer:
                      namespace: local
                      type: PERSON
                      value: null
                      name: Dr. House
                    systemId: EMR
                - uid: a51f0df6-0761-420d-a469-8363aed9a8e5
                  organizationUid: 41467ac9-18a0-49d8-bbdd-5954efb13399
                  ehrUid: afd64629-93a9-49ea-b7f8-540106bba979
                  versions:
                    - '8c3997ce-c59b-406a-823f-ecf1be4bb436::EMR::1'
                  audit:
                    timeCommitted: '2017-06-05 19:52:38'
                    committer:
                      namespace: local
                      type: PERSON
                      value: null
                      name: Dr. House
                    systemId: EMR
              pagination:
                max: 20
                offset: 0
                nextOffset: 20
                prevOffset: 0
  /compositions:
    get:
      summary: Get clinical document indexes from an EHR.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: ehrUid
          in: query
          type: string
          required: true
        - name: max
          in: query
          description: number or EHRs per page
          required: false
          type: integer
          format: int32
          default: 10
        - name: offset
          in: query
          description: pagination offset
          required: false
          type: integer
          format: int32
          default: 0
      produces:
        - application/json
      responses:
        '200':
          description: 'Clinical document indexes from an EHR, with pagination data.'
          examples:
            application/json:
              result:
                - uid: 93b93687-135d-4189-ad01-1b8e1ac13289
                  category: event
                  startTime: '2017-02-11 19:57:19'
                  subjectId: '11111111'
                  ehrUid: c35dfe02-4ece-465e-9433-0540c6d95f3f
                  templateId: Simple Encounter
                  archetypeId: openEHR-EHR-COMPOSITION.encounter.v1
                  lastVersion: true
                  organizationUid: d8b5bcb6-f26a-4192-a754-b98f62cdc4a4
                  parent: 'fc6da40a-3745-4a1f-9914-4fba03f746d9::EMR::1'
                - uid: 0c6322d2-c5e1-4bb1-8648-eabb21023d5e
                  category: event
                  startTime: '2017-02-11 20:00:09'
                  subjectId: '11111111'
                  ehrUid: c35dfe02-4ece-465e-9433-0540c6d95f3f
                  templateId: Simple Lab Order
                  archetypeId: openEHR-EHR-COMPOSITION.request.v1
                  lastVersion: true
                  organizationUid: d8b5bcb6-f26a-4192-a754-b98f62cdc4a4
                  parent: '6754831a-2f6c-448e-b8de-078a1bf6ba2f::EMR::1'
              pagination:
                max: 30
                offset: 0
                nextOffset: 30
                prevOffset: 0
              timing: 0 ms
  '/compositions/{uid}':
    get:
      summary: Get a composition by it's UID.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: descripcion de parametro format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: uid
          in: path
          type: string
          required: true
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: Composition resource (example is not a complete composition!)
          schema:
            type: object
          examples:
            application/json:
              version:
                '@xmlns:xsi': 'http://www.w3.org/2001/XMLSchema-instance'
                '@xmlns': 'http://schemas.openehr.org/v1'
                '@xsi:type': ORIGINAL_VERSION
                contribution:
                  id:
                    '@xsi:type': HIER_OBJECT_ID
                    value: ad6866e1-fb08-4e9b-a93b-5095a2563775
                  namespace: 'EHR::COMMON'
                  type: CONTRIBUTION
                commit_audit:
                  system_id: CABOLABS_EHR
                  committer:
                    '@xsi:type': PARTY_IDENTIFIED
                    name: Dr. Pablo Pazos
                  time_committed:
                    value: '20140901T233114,065-0300'
                  change_type:
                    value: creation
                    defining_code:
                      terminology_id:
                        value: openehr
                      code_string: 249
                uid:
                  value: '91cf9ded-e926-4848-aa3f-3257c1d89554::EMR_APP::1'
                data:
                  '@archetype_node_id': openEHR-EHR-COMPOSITION.test_all_datatypes.v1
                  '@xsi:type': COMPOSITION
                  name:
                    value: Test all datatypes
                  uid:
                    '@xsi:type': HIER_OBJECT_ID
                    value: d6fa1aa6-cfc7-4c28-ba51-555ee55b0ae1
  '/ehrs/{ehrUid}/compositions':
    post:
      summary: Commit multiple compositions into an EHR.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: descripcion de parametro format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: ehrUid
          in: path
          type: string
          required: true
        - name: versions
          in: body
          description: list of versioned compositions that are being committed on an EHR.
          required: true
          schema:
            type: object
      consumes:
        - application/json
        - text/xml
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: Composition resource (example is not a complete composition!)
          examples:
            application/json: {}
  /queries:
    get:
      summary: Queries shared with the current organization.
      tags:
        - queries
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: max
          in: query
          description: number or EHRs per page
          required: false
          type: integer
          format: int32
          default: 10
        - name: offset
          in: query
          description: pagination offset
          required: false
          type: integer
          format: int32
          default: 0
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: Query list with pagination data.
          schema:
            type: array
            items:
              $ref: '#/definitions/Query'
  '/queries/{uid}':
    get:
      summary: Get a query by it's UID
      tags:
        - queries
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: uid
          in: path
          description: UID of the query
          required: true
          type: string
      responses:
        '200':
          description: Query list with pagination data.
          schema:
            $ref: '#/definitions/Query'
  '/queries/{uid}/execute':
    get:
      summary: Execute a query and get data from the EHRServer
      tags:
        - queries
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: uid
          in: path
          description: UID of the query
          required: true
          type: string
        - name: ehrUid
          in: query
          description: filter query results by this EHR
          type: string
          required: false
        - name: organizationUid
          in: query
          description: >-
            UID of the organization associated with the EHRs being queried,
            mixed data from different organizations is not allowed
          required: true
          type: string
        - name: retrieveData
          in: query
          description: >-
            for composition queries, this set to true returns the full
            compositions instead on an index
          required: false
          type: boolean
        - name: group
          in: query
          description: overrides the default grouping of a datavalue query
          required: false
          type: string
          enum:
            - none
            - composition
            - path
          default: path
        - name: fromDate
          in: query
          description: date filter yyyyMMdd
          required: false
          type: string
          pattern: '/(\d{4})(\d{2})(\d{2})/'
        - name: toDate
          in: query
          description: date filter yyyyMMdd
          required: false
          type: string
          pattern: '/(\d{4})(\d{2})(\d{2})/'
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: >-
            Query result strutures, depending on the type of query (composition
            or databavlue). For datavalue queries, the resulting structure will
            depend on the grouping strategy selected.
          examples:
            datavalue query group by path:
              'openEHR-EHR-OBSERVATION.blood_pressure.v1/data[at0001]/events[at0006]/data[at0003]/items[at0004]/value<DV_QUANTITY>':
                type: DV_QUANTITY
                name: Sistólica
                serie:
                  - magnitude: 106
                    units: 'mm[Hg]'
                    date: '2016-01-14 07:34:59'
              'openEHR-EHR-OBSERVATION.blood_pressure.v1/data[at0001]/events[at0006]/data[at0003]/items[at0005]/value<DV_QUANTITY>':
                type: DV_QUANTITY
                name: Diastólica
                serie:
                  - magnitude: 56
                    units: 'mm[Hg]'
                    date: '2016-01-14 07:34:59'
              timing: 10 ms
            composition query with retrieveData=false:
              results:
                - uid: 0f78e043-aa09-4212-9669-fcef0adaf470
                  category: event
                  startTime: '2016-06-25 07:29:28'
                  subjectId: 11111111-1111-1111-1111-111111111111
                  ehrUid: 11111111-1111-1111-1111-111111111111
                  templateId: Signos
                  archetypeId: openEHR-EHR-COMPOSITION.signos.v1
                  lastVersion: true
                  organizationUid: d04809ca-08dc-454a-8390-96a0b125abf1
                  parent: '90120202-e7a6-4032-a935-fe91f6e7fd28::EMR::1'
              timing: 312 ms
  /checkout:
    get:
      summary: get the latest version of a composition with intent of modifying it.
      tags:
        - ehrs
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: ehrUid
          in: query
          description: identifier of the EHR containing the composition
          required: true
          type: string
        - name: compositionUid
          in: query
          description: identifier of the composition being checked out
          required: true
          type: string
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: Composition version
  /organizations:
    get:
      summary: >-
        get the organizations associated with the current user, the same
        organizations will be retrieved from the user's profile
      tags:
        - administrative
      parameters:
        - name: Authorization
          in: header
          type: string
          default: Bearer _your_token_here_
        - name: format
          in: query
          description: desired output format
          required: false
          type: string
          enum:
            - xml
            - json
          default: json
        - name: ehrUid
          in: query
          description: identifier of the EHR containing the composition
          required: true
          type: string
      produces:
        - application/json
        - text/xml
      responses:
        '200':
          description: List of organizations.
          examples:
            organizations:
              - uid: 4f9cfbe4-8cdd-43fc-b0de-5544305fcdd5
                name: Hospital de Clinicas
              - uid: 4ea72e8c-9707-4e1e-8acc-9e10e61b2037
                name: Clinica del Tratamiento del Dolor
definitions:
   Version:
    type:object
    properties:
        
       # no se como representarlo "@xsi:type" : "ORIGINAL_VERSION", 
       uid:
            type:string
            description:Unique identifier of this version, containing owner_id, creating_system_id and version_tree_id.        
       data: #creo que es composition.
            type:"#/definitions/Composition"
            description:
       lifecycle_state:
            type:"#/definitions/DV_CODED_TEXT"
            descritpion:Lifecycle state of this version; coded by openEHR vocabulary “version lifecycle state”.
       contribution: 
            type:ref: "#/definitions/Contribution"
            description:Contribution in which this version was added.
       commit_audit: 
            type:$ref: "#/definitions/Audit_details"
            description:Audit trail corresponding to the committal of this version to the VERSIONED_OBJECT.
  Contribution:
    type:object
    properties:
       uid: 
            type:string
            description:Unique identifier for this contribution.
       versions: 
            type:array
            description:Set of references to versions causing changes to this EHR. Each contribution contains a list of versions, which may include paths pointing to any number of VERSIONABLE items, i.e. items of type COMPOSITION and FOLDER.
            items:
                type:string
      audit:
            type:$ref: "#/definitions/Audit_details"
            description:Audit trail corresponding to the committal of this Contribution.
  Audit_details:
    type:object
    properties:
       system_id:
          type:string
          description: Identity of the system where the change was committed. Ideally this is a machine- and human-processable identifier, but it may not be.
       time_committed: 
          type:$ref: "#/definitions/DV_DATE_TIME"
          description:Time of committal of the item.
       change_type: 
          type:$ref: "#/definitions/DV_CODED_TEXT"        
          description:Type of change. Coded using the openEHR Terminology “audit change type” group.
       description: 
          type:$ref: "#/definitions/DV_TEXT"
          description:Reason for committal.          
       committer: 
          type:string
          description:Identity and optional reference into identity management service, of user who committed the item.  
  Composition:
    type:object
    properties:
        uid:
           type:string
           description:Optional globally unique object identifier for root points of archetyped structures.
        archetype_node_id: 
            type:string 
            description:Design-time archetype id of this node taken from its generating archetype; used to build archetype paths. Always in the form of an “at” code, e.g. “at0005”. This value enables a "standardised" name for this node to be generated, by
            referring to the generating archetype local ontology. At an archetype root point, the value of this attribute is always the stringified form of the archetype_id found in the archetype_details object.
        name: 
            type:$ref: "#/definitions/DV_TEXT" 
            description:Runtime name of this fragment, used to build runtime paths. This is the term providedvia a clinical application or batch process to name this EHR construct: its retention in the EHR faithfully preserves
            the original label by which this entry was known to end users.
        archetype_details:
            type:$ref: "#/definitions/Archetyped"
            description:Details of archetyping used on this node.
        feeder_audit: 
            type:$ref: "#/definitions/Fedder_Audit"
            description:Audit trail from non-openEHR system of original commit of information forming the content of this node, or from a conversion gateway which has synthesised this node.
        links:
            type:set
            description:Links to other archetyped structures (data whose root object inherits from ARCHETYPED, such as ENTRY, SECTION and so on). Links may be to structures in other compositions.
            Details of archetyping used on this node   
            items:
                type:$ref: "#/definitions/LINK"
        content: 
            type:List
            description:The content of this Composition.
            items:
                type:$ref: "#/definitions/Content_item"
        context: 
            type: $ref: "#/definitions/Event_Context" 
            description:The clinical session context of this Composition, i.e. the contextual attributes of the clinical session.
        composer: 
            type: string
            description:The person primarily responsible for the content of the Composition (but not necessarily its committal into the EHR system). This is the identifier which should
            appear on the screen. It may or may not be the person who entered the data. When it is the patient, the special “self” instance of PARTY_PROXY will be used.
        category: 
            type:$ref: "#/definitions/DV_CODED_TEXT" 
            description:Indicates what broad category this Composition is belogs to, e.g. “persistent” - of longitudinal validity, “event”, “process” etc.
        language: 
            type: $ref: "#/definitions/Code_Phase"  
            description:Mandatory indicator of the localised language in which this Composition is written. Coded from openEHR Code Set “languages”. The language of an Entry if
            different from the Composition is indicated in ENTRY.language.
        territory: 
            type:$ref: "#/definitions/Code_Phase"  
            description:Name of territory in which this Composition was written. Coded from openEHR “countries” code set, which is an expression of the ISO 3166 standard.               
  Archetyped:
    type:object
    properties:
        archetype_id:
            type:string 
            description:Globally unique archetype identifier.
        template_id: 
            type:string 
            description:Globally unique template identifier, if a template was active at this point in the structure. Normally, a template would only be used at the top of a top-level structure, but the possibility
            exists for templates at lower levels.
        rm_version: 
            type:string
            description:Version of the openEHR reference model used to create this object. Expressed in terms of the release version string, e.g. “1.0”,“1.2.4”.
   Fedder_Audit:
    type:object
    properties:
        originating_system_audit:
            type:$ref: "#/definitions/Feeder_Audit_Details" 
            description: Any audit information for the information item from the originating system.
        originating_system_item_ids:
            type:list
            description:Identifiers used for the item in the originating system, e.g. filler and placer ids.
            items:
                type:$ref: "#/definitions/DV_IDENTIFIER" 
        feeder_system_audit:
            type:$ref: "#/definitions/Feeder_Audit_Details" 
            description:Any audit information for the information item from the feeder system, if different fromthe originating system.
        feeder_system_item_ids:
            type:list
            description:Identifiers used for the item in the feeder system, where the feeder system is distinct from the originating system.
            items:
                type:$ref: "#/definitions/DV_IDENTIFIER" 
        original_content:
             type:$ref: "#/definitions/DV_ENCAPSULATED" 
            description: Optional inline inclusion of or reference to original content corresponding to the openEHR content at this node. Typically aURI reference to a document or message in
  DV_CODED_TEXT:
    type:object
    properties:
        defining_code:
            type:$ref: "#/definitions/Code_Phase"
            description:The term which the ‘value’ attribute is the textual rendition (i.e. rubric) of.
  DV_TEXT:
     type:object
     properties:
        value:
            type:string
            description: Displayable rendition of the item, regardless of its underlying structure. For DV_CODED_TEXT, this is the rubric of the complete term as provided by the terminology service. No carriage returns, line feeds, or other non-printing characters permitted. 
        hyperlink:
            type:
            description:
        formatting:
            type:string
            description: A format string of the form name:value; name:value…​ , e.g. "font-weight : bold; font-family : Arial; font-size : 12pt;".
        mappings:
            type:
            description:
        language:
            type:"#/definitions/Code_Phase"
            description: Optional indicator of the localised language in which the value is written. Coded from openEHR Code Set languages .
        encodings:
            type:"#/definitions/Code_Phase"
            description:Name of character encoding scheme in which this value is encoded. Coded from openEHR Code Set character sets .      
  DV_DURATION:
     type:object
     properties:
        value:
            type:string
            description:ISO8601 duration. 
  DV_DATE_TIME:         
    type:object
    properties:
        value:
            type:string
            description:ISO8601 date/time string          
  DV_EHR_URI:
     type:object
     properties:
        schme:
            type:string
            description:A distributed information "space" in which information objects exist. The scheme simultaneously specifies an information space and a mechanism for accessing objects in that space. For example if
            scheme = "ftp", it identifies the information space in which all ftpable objects exist, and also the application - ftp - which can be used to access them. Values may include "ftp", "telnet", "mailto",
            "gopher" and many others. Refer to WWW URI RFC for a full list. New information spaces can be accommodated within the URI specification.
        path: 
            type:string
            description:A string whose format is a function of the scheme. Identifies the location in <scheme>- space of an information entity. Typical values include hierarchical directory paths for any machine. For example, with scheme = "ftp", path
            might be /pub/images/image_01. The strings "." and ".." are reserved for use in the path. Paths may include internet/intranet location identifiers of the form sub_domain...domain, e.g. "info.cern.ch"
        fragment_id: 
            type:string
            description:A part of, a fragment or a sub-function within an object. Allows references to sub-parts of objects, such as a certain line and character position in a text object. The syntax and semantics are defined
            by the application responsible for the object.
        query: 
            type:string
            description:Query string to send to application implied by scheme and path Enables queries to applications, including databases to be included in the URI Any query meaningful to the server, including SQL.           
  DV_IDENTIFIER:
     type:object
     properties:
        issuer:
            type:string
            description:Authority which issues the kind of id used in the id field of this object. 
        assigner: 
            type:string
            description:Organisation that assigned the id to the item being identified.
        id: 
            type:string.
            description:String The identifier value. Often structured, according to the definition of the issuing authority’s rules.
        type: 
            type:string
            description:The identifier type, such as “prescription”, or “SSN”. One day a controlled vocabulary might be possible for this.            
  DV_ENCAPSULATED:
     type:object
     properties:
        schme:
            size:integer
            description:Original size in bytes of unencoded encapsulated data. I.e. encodings such as base64, hexadecimal etc do not change the value of this attribute.
        charset: 
            type:"#/definitions/Code_Phase" 
            description:Name of character encoding scheme in which this value is encoded. Coded from openEHR Code Set “character sets”. Unicode is the default assumption in openEHR, with UTF-8 being the assumed encoding. This attribute
            allows for variations from these assumptions.
        language: 
            type:"#/definitions/Code_Phase"
            description:Optional indicator of the localised language in which the data is written, if relevant. Coded from openEHR Code Set “languages”.            
  LINK:
     type:object
     properties:
        meaning:
            type:"#/definitions/DV_TEXT"
            description:Used to describe the relationship, usually in clinical terms, such as “in response to” (the relationship between test results and an order), “follow-up to” and so on. Such relationships can represent any clinically meaningful connection between pieces of information.
        type:
            type:"#/definitions/DV_TEXT"
            description:The type attribute is used to indicate a clinical or domain-level meaning for the kind of link, for example “problem” or “issue”. If type values are designed appropriately, they can be used by the requestor of EHR extracts to categorise links which must be followed and which can be broken when the extract is created. 
        target:
            type:"#/definitions/DV_EHR_URI"
            description:The logical “to” object in the link relation, as per the linguistic sense of the meaning attribute.    
  Code_Phase:
     type:object
     properties:
        terminology_id:
            type:"#/definitions/Terminology_Id"
            description: Identifier of the distinct terminology from which the code_string (or its elements) was extracted.
        code_string:
            type:string
            description: The key used by the terminology service to identify a concept or coordination of concepts. This string is most likely parsable inside the terminology service, but nothing can be assumed about its syntax outside that context.
  Terminology_id:
     type:object
     properties:
        scheme:
            type:string
            description:Name of the scheme to which this identifier conforms. Ideally this name will be recognisable globally but realistically it may be a local ad hoc scheme whose name is not controlled or standardised in any way.
 Content_item:
    type:object
    properties:
        uid:
           type:string
           description:Optional globally unique object identifier for root points of archetyped structures.
        archetype_node_id: 
            type:string 
            description:Design-time archetype id of this node taken from its generating archetype; used to build archetype paths. Always in the form of an “at” code, e.g. “at0005”. This value enables a "standardised" name for this node to be generated, by
            referring to the generating archetype local ontology. At an archetype root point, the value of this attribute is always the stringified form of the archetype_id found in the archetype_details object.
        name: 
            type:$ref: "#/definitions/DV_TEXT" 
            description:Runtime name of this fragment, used to build runtime paths. This is the term providedvia a clinical application or batch process to name this EHR construct: its retention in the EHR faithfully preserves
            the original label by which this entry was known to end users.
        archetype_details:
            type:$ref: "#/definitions/Archetyped"
            description:Details of archetyping used on this node.
        feeder_audit: 
            type:$ref: "#/definitions/Fedder_Audit"
            description:Audit trail from non-openEHR system of original commit of information forming the content of this node, or from a conversion gateway which has synthesised this node.
        links:
            type:set
            description:Links to other archetyped structures (data whose root object inherits from ARCHETYPED, such as ENTRY, SECTION and so on). Links may be to structures in other compositions.
            Details of archetyping used on this node   
            items:
                type:$ref: "#/definitions/LINK"
  Event_context:
    type:object
    properties:
        health_care_facility:
            type:string
            description:The health care facility under whose care the event took place. This is the most specific workgroup or delivery unit within a care delivery enterprise that has an official identifier in the health system,
            and can be used to ensure medico-legal accountability.
        start_time:
            type:$ref: "#/definitions/DV_DATE_TIME"
            description:Start time of the clinical session or other kind of event during which a provider performs a service of any kind for the patient.
        end_time: 
            type:$ref: "#/definitions/DV_DATE_TIME" 
            description:Optional end time of the clinical session.
        participations:
            type:list
            description:Parties involved in the healthcare event. These would normally include the physician(s) and often the patient (but not the latter if the clinical session is a pathology test for example).
            items:
                 type:$ref: "#/definitions/PARTICIPATION"
        location: 
            type:string
            description:The actual location where the session occurred, e.g. “microbiol lab 2”, “home”,“ward A3” and so on.
        setting: 
            type:$ref: "#/definitions/DV_CODED_TEXT" 
            description:The setting in which the clinical session took place. Coded using the openEHR Terminology, “setting” group.
        other_context: 
            type:$ref: "#/definitions/ITEM_STRUCTURE" 
            description:Other optional context which will be archetyped.
  ITEM_STRUCTURE:
    type:object
    properties:
        as_hierarchy: 
            type:$ref: "#/definitions/ITEM" 
            description:Hierarchical equivalent of the physical representation of each subtype, compatible with CEN EN 13606 structures
  ITEM:
    type:object
    properties:
        uid:
           type:string
           description:Optional globally unique object identifier for root points of archetyped structures.
        archetype_node_id: 
            type:string 
            description:Design-time archetype id of this node taken from its generating archetype; used to build archetype paths. Always in the form of an “at” code, e.g. “at0005”. This value enables a "standardised" name for this node to be generated, by
            referring to the generating archetype local ontology. At an archetype root point, the value of this attribute is always the stringified form of the archetype_id found in the archetype_details object.
        name: 
            type:$ref: "#/definitions/DV_TEXT" 
            description:Runtime name of this fragment, used to build runtime paths. This is the term providedvia a clinical application or batch process to name this EHR construct: its retention in the EHR faithfully preserves
            the original label by which this entry was known to end users.
        archetype_details:
            type:$ref: "#/definitions/Archetyped"
            description:Details of archetyping used on this node.
        feeder_audit: 
            type:$ref: "#/definitions/Fedder_Audit"
            description:Audit trail from non-openEHR system of original commit of information forming the content of this node, or from a conversion gateway which has synthesised this node.
        links:
            type:set
            description:Links to other archetyped structures (data whose root object inherits from ARCHETYPED, such as ENTRY, SECTION and so on). Links may be to structures in other compositions.
            Details of archetyping used on this node   
            items:
                type:$ref: "#/definitions/LINK"
  Participation:
    type:object
    properties:
        performer:
            type:string
            description:The id and possibly demographic system link of the party participating in the activity.
        function: 
            type:$ref: "#/definitions/DV_TEXT"
            description:The function of the Party in this participation (note that a given party might participate in more than one way in a particular activity). This attribute should be coded, but cannot be limited to the
            HL7v3 ParticipationFunction vocabulary, since it is too limited and hospital-oriented.
        mode: 
            type:$ref: "#/definitions/DV_CODED_TEXT"
            description:The mode of the performer / activity interaction, e.g. present, by telephone, by email etc.
        time: 
            #No se como representar este
            type:$ref: "#/definitions/DV_CODED_TEXT"DV_INTERVAL<DV_DATE_TIME>
            description:The time interval during which the participation took place, if it is used in an observational context (i.e. recording facts about the past); or the intended time interval of the participation when used in future contexts, such as EHR Instructions.
  Feeder_Audit_Details:  
    type:object
    properties:
        system_id: 
            type:string:
            description:Identifier of the system which handled the information item.
        provider:
            type:string
            description:Optional provider(s) who created, committed,forwarded or otherwise handled the item.
        location:
            type:string
            description:Identifier of the particular site/facility within an organisation which handled the item. For computability, this identifier needs to be e.g. a PKI identifier which can be included in the
            identifier list of the PARTY_IDENTIFIED object.
        time: 
            type:"#/definitions/DV_DATE_TIME"
            description:Time of handling the item. For an originating system, this will be time of creation, for an intermediate feeder system, this will be a time of accession or other time of handling, where available.
        subject: 
            type:string
            description:Identifiers for subject of the received information item.
        version_id: 
            type:string
            description: Any identifier used in the system such as “interim”, “final”, or numeric versions if available.
  Ehr:
    type: object
    properties:
      systemId:
        type: string
        description: The id of the EHR system on which this EHR was created
      uid:
        type: string
        description: >-
          Emula un HIER_OBJECT_ID.root y su valor va a ser un UUID
          (java.util.UUID.randomUUID() as String) que se asigna en el momento
          que se crea el EHR
      dateCreated:
        type: string
        format: date
        description: >-
          Emula timeCreated, se setea automaticamente por Grails en el momento
          de crear el EHR
      subject:
        type: string
        description: Emula EHR.ehr_status......subject
      organizationUid:
        type: string
        description: organizationUid
  Query:
    type: object
    properties:
      uid:
        type: string
        description: unique identifier
      name:
        type: string
        description: name of the query
      type:
        type: string
        description: type of query
        enum:
          - composition
          - datavalue
        default: composition
      format:
        type: string
        description: output format for query reulsts
      group:
        type: string
        description: type of grouping for datavalue queries
        enum:
          - none
          - composition
          - path
        default: path
      projections:
        type: array
        items:
          properties:
            arthcetype_id:
              type: string
              description: identifier of the archetype
            path:
              type: string
              description: valid path inside the archetype
        description: datavalue projections of the query
      criteria:
        type: array
        items:
          properties:
            arthcetype_id:
              type: string
              description: identifier of the archetype
            path:
              type: string
              description: valid path inside the archetype
            conditions:
              type: object
              description: >-
                conditions depend on the datavalue, e.g. for DV_QUANITTY the
                conditions object can be: {"magnitude": {"gt": [140.0]},"units":
                {"eq": "mm[Hg]"}}
        description: composition queries are fildered by criteria
  Error:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      fields:
        type: string
